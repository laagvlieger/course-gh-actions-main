name: thanks

on:
    issues:
      types: [opened]
    workflow_dispatch: # manual

jobs:
    thanks:
        runs-on: ubuntu-latest
        permissions:
          issues: write
        steps:
            - uses: actions/github-script@v7
              id: issue-script
              with:
                github-token: ${{ secrets.GITHUB_TOKEN }}
                script: |
                    const issue_number = context.issue.number || 2;
                    console.log(`issue_number: ${issue_number}`);
                    const owner = context.repo.owner;
                    const repo = context.repo.repo;
                   
                    // Lookup issue info
                    const issue = await github.rest.issues.get({
                      owner,
                      repo,
                      issue_number
                    });

                    // dit is de callback
                    console.log(`issue: ${JSON.stringify(issue.data)}`);
                    const comment = await github.rest.issues.createComment({
                      owner,
                      repo,
                      issue_number,
                      body: `Thanks for your contribution!`
                    });
                    console.log(`comment: ${JSON.stringify(comment.data.id)}`);
                    console.log(comment.data);

                    // auto label bla
                    github.rest.issues.addLabels({
                      owner,
                      repo,
                      issue_number,
                      labels: ['todo-review']
                    });

                    // make comment availble to subequent steps
                    return comment.data.id;

            - run: echo "comment id=${{ steps.issue-script.outputs.result }}"

            